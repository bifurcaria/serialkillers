<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <!-- CSS de Bootstrap-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
        <style>
            @import url("https://fonts.googleapis.com/css2?family=Trispace:wght@300;400;600&display=swap");

            :root {
                --bs-body-font-family: "Trispace", sans-serif;
                --bs-body-color: #eef;
                --bs-body-bg: #10121c;
            }
        </style>
        <title>Introducción al Desarrollo Front End con HTML, CSS y JavaScript</title>
    </head>
    <body>
        <header>
            <div class="container">
                <div class="row pt-5">
                    <div class="col-sm-10 col-md-8 col-lg-6 mx-auto">
                        <h1 class="display-4 text-center py-2">Titanic</h1>
                        <p class="lead">
                            Dos años fueron necesarios para construir el Titanic, también conocido como el barco insumergible. Y sin embargo, después de navegar durante cuatro días y medio, y, tras chocar con un iceberg, se hundió en apenas
                            dos horas y 40 minutos.
                        </p>
                        <p>
                            El 10 de abril de 1912 el Titanic zarpó desde Southampton en su viaje inaugural, que tenía por destino final a Nueva York. El barco insumergible cruzó el canal de la Mancha hasta su primera escala, Cherburgo, en
                            Normandía. Posteriormente viajó hasta el puerto de Queenstown (hoy Cork, Irlanda) para recoger a los últimos pasajeros antes de adentrarse en el océano Atlántico.
                        </p>
                        <p>De los <a href="https://github.com/datasciencedojo/datasets/blob/master/titanic.csv" target="_blank" class="link-light">registros de 891 pasajeros</a>, podemos obtener algunos datos:</p>
                    </div>
                </div>
            </div>
        </header>

        <main class="container">
            <div class="accordion mx-md-5 my-5 rounded-0" id="accordionExample">
                <!--Edades de pasajeros-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header bg-dark" id="headingOne">
                        <button class="accordion-button rounded-0" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Victimas por asesino</button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Gráfico 1</p>
                            <div class="col-md-6 mx-auto mb-3">
                                <canvas id="victimas" width="100" height="100"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Pasajeras y pasajeros-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Asesinos por país</button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Gráfico 2</p>
                            <div class="col-md-6 mx-auto mb-3">
                                <canvas id="paises" width="100" height="100"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Clases-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Asesinos por género</button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Gráfico 3</p>
                            <div class="col-md-6 mx-auto mb-3">
                                <canvas id="genero" width="100" height="100"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Sobrevivientes por clases-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingFour">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">Víctimas probadas y posibles</button>
                    </h2>
                    <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Gráfico 4</p>
                            <canvas id="victimasposibles" width="100" height="30"></canvas>
                        </div>
                    </div>
                </div>
                <!--Mujeres y niños primero-->
                <div class="accordion-item rounded-0">
                    <h2 class="accordion-header" id="headingFive">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">Tiempo de actividad por asesino</button>
                    </h2>
                    <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#accordionExample">
                        <div class="accordion-body text-black-50">
                            <p>Gráfico 5</p>
                            <canvas id="tiempo" width="100" height="30"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-10 col-md-8 col-lg-6 mx-auto">
                    <p>Los registros de 891 representan una parte de los más de 2.400 personas que viajaban en el Titanic aquel fatídico 14 de abril de 1912, cuando la nave choca con el iceberg faltando minutos para la medianoche.</p>
                </div>
            </div>
        </main>

        <aside>
            <div class="container">
                <div class="row py-5">
                    <div class="col-sm-10 col-md-8 col-lg-6 mx-auto small text-center">
                        <p>
                            Fuentes: <a href="https://historia.nationalgeographic.com.es/a/historia-titanic-tragedia-barco-insumergible_16344">La historia del Titanic, la tragedia del barco insumergible</a>,
                            <a href="https://rpubs.com/paraneda/titanic">RPubs - Titanic</a>, otra y otra más.
                        </p>
                    </div>
                </div>
            </div>
        </aside>

        <footer>
            <div class="container">
                <div class="row">
                    <div class="col"><p class="text-muted mt-5 text-center small">Bootstrap v5.1 y Charts.js</p></div>
                </div>
            </div>
        </footer>

        <!-- Biblioteca de Bootstrap -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <!-- Biblioteca Chart.js -->
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"
            integrity="sha512-QSkVNOCYLtj73J4hbmVoOV6KVZuMluZlioC+trLpewV8qMjsWqlIQvkn1KGX2StWvPMdWGBqim1xlC8krl1EKQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        ></script>
        <!-- Un gran script, que contiene una función asincrónica para ir a buscar un JSON con -->

        <script>
            async function todo() {

                //el fetch
                const consulta = await fetch("https://raw.githubusercontent.com/bifurcaria/serialkillers/main/datos.json");
                const data = await consulta.json();

console.log(data.Name)

                //algunas variables para calcular
                var nombres = [];
                var victimas = [];
                var victimasposibles = [];
                var paisesunicos = {};
                var genero = {};
                var anos = [];

                //consultando en cada elemento del arreglo
                data.forEach((item, i) => {
                    nombres.push(item.Name);
                    victimas.push(item.provenvictims);
                    victimasposibles.push(item.possiblevictims);
                    if (!Object.keys(paisesunicos).includes(item.Country)) {
                        paisesunicos[item.Country] = 1;
                    } else {
                        paisesunicos[item.Country] = paisesunicos[item.Country] + 1;
                    }
                    if (!Object.keys(genero).includes(item.Gender)) {
                        genero[item.Gender] = 1;
                    } else {
                        genero[item.Gender] = genero[item.Gender] + 1;
                    }
                    anos.push(item["Years active"].to - item["Years active"].from);

                });

                //y completemos un par de frase
                //document.querySelector("#total_mujeres").innerHTML = mujeres;
                //document.querySelector("#total_hombres").innerHTML = hombres;


                ;

                //victimas x asesino

                 //para ver si funciona
              console.log(nombres)
              console.log(victimas)
              console.log(paises)
              console.log(genero)

                new Chart(document.getElementById("victimas").getContext("2d"), {
                    type: "bar",
                    data: {
                        labels: nombres,
                        datasets: [{
                          data: victimas,
                          label: "Asesinos y víctimas",
                          backgroundColor: ["#F06EC4", "#AB72F7", "#7396E0", "#495F8F"],
                    }],
                    options: {
                        animation: false,
                        layout: {
                            padding: 10,
                        },
                    },
                },
            });

                //asesinos x pais
                new Chart(document.getElementById("paises").getContext("2d"), {
                    type: "polarArea",
                    data: {
                        labels: Object.keys(paisesunicos),
                        datasets: [{
                            data: Object.values(paisesunicos),
                            label: "Total",
                            backgroundColor: ["#f00", "#00f", "#0ff"] }],
                    },
                    options: {
                        animation: false,
                        layout: {
                            padding: 10,
                        },
                    },
                });
                // genero

                new Chart(document.getElementById("genero").getContext("2d"), {
                    type: "pie",
                    data: {
                        labels: Object.keys(genero),
                        datasets: [{
                            data: Object.values(genero),
                            label: "Total",
                            backgroundColor: ["#f00", "#00f"] }],
                    },
                    options: {
                        animation: false,
                        layout: {
                            padding: 10,
                        },
                    },
                });
                //victimas posibles y probadas

                new Chart(document.getElementById("victimasposibles").getContext("2d"), {
                    type: "bar",
                    data: {
                        labels: nombres,
                        datasets: [{
                          data: victimas,
                          label: "Víctimas comprobadas",
                          backgroundColor: ["#F06EC4"],
                    }, {
                          data: victimasposibles,
                          label: "Víctimas posibles",
                          backgroundColor: ["#AB72F7"],
                    }],
                    options: {
                        animation: false,
                        layout: {
                            padding: 10,
                        },
                    },
                },
            });

                //tiempo de actividad
                new Chart(document.getElementById("tiempo").getContext("2d"), {
                    type: "bar",
                    data: {
                        labels: nombres,
                        datasets: [{
                          data: anos,
                          label: "Años activos por asesino",
                          backgroundColor: ["#F06EC4", "#AB72F7", "#7396E0", "#495F8F"],
                    }],
                    options: {
                        animation: false,
                        layout: {
                            padding: 10,
                        },
                    },
                },
            });
            ;
            }
            todo().catch((error) => console.error(error));
        </script>
        <!--otro para los extras-->
        <script>
            // No todo se resuelve con pie, doughthout o barras, a veces se necesitan otros gráficos

            async function otro() {
                //el fetch
                const consulta = await fetch("https://raw.githubusercontent.com/facoasecas/datos_varios/main/paises.json");
                const data = await consulta.json();
                var puntos = [];
                var burbujas = [];
                data.forEach((d) => {
                    let info = { x: d.pib_per_capita, y: d.idh, pais: d.pais };
                    let mas = { x: d.pib_per_capita, y: d.idh, r: Math.round(d.poblacion / 50000000), pais: d.pais };
                    puntos.push(info);
                    burbujas.push(mas);
                });
                           }
            otro().catch((error) => console.error(error));
        </script>
    </body>
</html>
